["import sys\n(n, q) = [int(i) for i in sys.stdin.readline().split()]\na = [int(i) for i in sys.stdin.readline().split()]\nb = [int(i) for i in sys.stdin.readline().split()]\nd = [a[i] - b[i] for i in range(n)]\nsd = [0]\nfor i in d:\n    sd.append(sd[-1] + i)\n(ma, mi) = ([[]], [[]])\nma[0] = mi[0] = sd\nfor i in range(1, 17):\n    l = 1 << i - 1\n    ma.append([max(ma[-1][j], ma[-1][j + l]) for j in range(len(sd) - l * 2 + 1)])\n    mi.append([min(mi[-1][j], mi[-1][j + l]) for j in range(len(sd) - l * 2 + 1)])\nfor _ in range(q):\n    (a, b) = [int(i) for i in sys.stdin.readline().split()]\n    l = (b - a).bit_length() - 1\n    m1 = max(ma[l][a], ma[l][b + 1 - (1 << l)])\n    m2 = min(mi[l][a], mi[l][b + 1 - (1 << l)])\n    sys.stdout.write('%d\\n' % (m1 - m2 if m1 == sd[a - 1] and m1 == sd[b] else -1))"]