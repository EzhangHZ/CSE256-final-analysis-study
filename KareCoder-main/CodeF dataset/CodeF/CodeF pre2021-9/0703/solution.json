["import sys\n\ndef main():\n    iter_data = map(int, sys.stdin.read().split())\n    t = next(iter_data)\n    for t_it in range(t):\n        (n, q) = (next(iter_data), next(iter_data))\n        a = [0] + [next(iter_data) for _ in range(n)] + [0]\n        all_ans = [0] * (q + 1)\n        val = [0] * (n + 1)\n        for i in range(n + 1):\n            val[i] = max(a[i], a[i + 1])\n        cur_ans = sum(val) - sum(a)\n        all_ans[0] = cur_ans\n        for q_it in range(1, q + 1):\n            (l, r) = (next(iter_data), next(iter_data))\n            if l != r:\n                (a[l], a[r]) = (a[r], a[l])\n                cur_ans -= val[l - 1] + val[l] + val[r]\n                val[l - 1] = max(a[l - 1], a[l])\n                val[l] = max(a[l], a[l + 1])\n                val[r] = max(a[r], a[r + 1])\n                cur_ans += val[l - 1] + val[l] + val[r]\n                if r - l > 1:\n                    cur_ans -= val[r - 1]\n                    val[r - 1] = max(a[r - 1], a[r])\n                    cur_ans += val[r - 1]\n            all_ans[q_it] = cur_ans\n        print(*all_ans, sep='\\n')\nmain()"]