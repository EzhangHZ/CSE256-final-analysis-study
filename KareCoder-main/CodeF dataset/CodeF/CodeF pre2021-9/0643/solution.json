["import sys\ninput = sys.stdin.readline\nimport math\nmnum = 10 ** 6 + 1000\nmnumsqr = math.ceil(math.sqrt(mnum)) + 10\nmCanDivSqrt = [-1] * (mnum + 10)\nfor i in range(2, mnumsqr):\n    if i ** 2 < mnum + 1:\n        cur = i ** 2\n        x = cur\n        while x <= mnum:\n            mCanDivSqrt[x] = i ** 2\n            x += cur\n\ndef do():\n    n = int(input())\n    dat = list(map(int, input().split()))\n    buf = []\n    import collections\n    d = collections.defaultdict(int)\n    res0 = 0\n    for x in dat:\n        while True:\n            if mCanDivSqrt[x] != -1:\n                x //= mCanDivSqrt[x]\n            else:\n                break\n        d[x] += 1\n        buf.append(x)\n    t = d[1]\n    res0 = max(t, 1)\n    for k in d.keys():\n        if k == 1:\n            continue\n        v = d[k]\n        res0 = max(res0, v)\n        if v % 2 == 0:\n            t += v\n    if t == 0:\n        t = 1\n    t = max(t, res0)\n    q = int(input())\n    for _ in range(q):\n        qnum = int(input())\n        if qnum == 0:\n            print(res0)\n        else:\n            print(t)\nq = int(input())\nfor _ in range(q):\n    do()", "from sys import stdin\nT = int(stdin.readline())\ndct = {i: i for i in range(1000001)}\nfor i in range(2, 1001):\n    for j in range(1, 10 ** 6 // i ** 2 + 1):\n        dct[i ** 2 * j] = j\nfor _ in range(T):\n    n = int(stdin.readline())\n    arr = list(map(int, stdin.readline().split()))\n    q = int(stdin.readline())\n    seen = {}\n    for i in range(n):\n        num = dct[arr[i]]\n        if num not in seen:\n            seen[num] = 1\n        else:\n            seen[num] += 1\n    max1 = 1\n    max2 = 0\n    for val in seen.values():\n        max1 = max(max1, val)\n        if val % 2 == 0:\n            max2 += val\n    if 1 in seen:\n        if seen[1] % 2 == 0:\n            pass\n        else:\n            max2 += seen[1]\n    for k in range(q):\n        if int(stdin.readline()) >= 1:\n            print(max(max1, max2))\n        else:\n            print(max1)"]