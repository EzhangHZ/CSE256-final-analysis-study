["import sys\nimport collections\nimport math\nMOD = int(1000000000.0) + 7\nMOD = 998244353\ninf = 1e+20\ninput = sys.stdin.readline\n\ndef f():\n    n = int(input())\n    s = input()\n    pre = 0\n    c = 0\n    res = 0\n    for i in range(n):\n        if pre != s[i]:\n            c = 1\n        else:\n            c *= 2\n        c %= MOD\n        res += c\n        pre = s[i]\n    return res % MOD\nfor case in range(int(input())):\n    print(f())", "import math\n\ndef solve():\n    n = int(input())\n    ans = 1\n    res = 1\n    s = input()\n    for i in range(1, n):\n        if s[i] != s[i - 1]:\n            ans = 1\n        else:\n            ans = 2 * ans % 998244353\n            ans = ans % 998244353\n        res = (ans + res) % 998244353\n    print(res)\nt = int(input())\nfor i in range(t):\n    solve()", "m = 998244353\nfor _ in range(int(input())):\n    n = int(input())\n    s = list(input())\n    i = 0\n    ans = 0\n    while i < n:\n        c = 1\n        j = i + 1\n        while j < n and s[j] == s[i]:\n            c += 1\n            j += 1\n        ans = (ans + (1 << c) - 1) % m\n        i = j\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    (ans, t) = (1, 1)\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            t = t * 2 % 998244353\n            ans = (ans + t) % 998244353\n        else:\n            t = 1\n            ans = (ans + t) % 998244353\n    print(ans)", "for tt in range(int(input())):\n    n = int(input())\n    s = input()\n    fx = [0] * n\n    fx[0] = 1\n    for i in range(1, n):\n        if s[i] != s[i - 1]:\n            fx[i] = 1\n        else:\n            fx[i] = fx[i - 1] * 2 % 998244353\n    print(sum(fx) % 998244353)", "for tt in range(int(input())):\n    n = int(input())\n    s = input()\n    fx = [0] * n\n    fx[0] = 1\n    for i in range(1, n):\n        if s[i] != s[i - 1]:\n            fx[i] = 1\n        else:\n            fx[i] = fx[i - 1] * 2 % 998244353\n    print(sum(fx) % 998244353)", "mod = 998244353\nfor _ in range(int(input())):\n    n = int(input())\n    t = input()\n    d = 1\n    dp = 1\n    for i in range(1, n):\n        if t[i] == t[i - 1]:\n            dp = dp * 2 % mod\n        else:\n            dp = 1\n        d = (d + dp) % mod\n    print(d)", "MOD = 998244353\n\ndef solve(n, s):\n    dp = [0] * (n + 1)\n    dp[0] = 1\n    for i in range(1, n):\n        dp[i] = dp[i - 1] * 2 if s[i - 1] == s[i] else 1\n        dp[i] %= MOD\n    return sum(dp) % MOD\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input()\n    ans = solve(n, s)\n    print(ans)", "t = int(input())\nmod = 998244353\nwhile t > 0:\n    n = int(input())\n    s = input()\n    ret = 1\n    pre = s[0]\n    count = 1\n    for i in s[1:]:\n        if i == pre:\n            count = count << 1\n            count = count % mod\n        else:\n            pre = i\n            count = 1\n        ret += count\n        ret = ret % mod\n    print(ret % mod)\n    t -= 1", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    a = input()\n    if n == 1:\n        print(1)\n    else:\n        count = 1\n        curr = 1\n        for i in range(1, n):\n            if a[i] == a[i - 1]:\n                curr = curr * 2 % 998244353\n            else:\n                curr = 1\n            count = (count + curr) % 998244353\n        print(count % 998244353)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    m = 998244353\n    s = input()\n    ans = 1\n    prev = 1\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            prev <<= 1\n            ans += prev\n        else:\n            prev = 1\n            ans += prev\n        if ans > m:\n            ans = ans % m\n        if prev > m:\n            prev = prev % m\n    print(ans)", "for i in range(int(input())):\n    mod = 998244353\n    n = int(input())\n    s = input()\n    ans = 1\n    count = 0\n    for i in range(1, n):\n        count = count + ans\n        count = count % mod\n        if s[i] == s[i - 1]:\n            ans = 2 * ans % mod\n        else:\n            ans = 1\n    count = count + ans\n    print(count % mod)", "t = int(input())\nmod = 998244353\nfor i in range(t):\n    n = int(input())\n    s = input()\n    first = s[0]\n    total = 1\n    ans = 1\n    for i in range(1, n):\n        current = s[i]\n        if current == first:\n            ans = ans * 2\n            ans %= mod\n        else:\n            ans = 1\n            first = current\n        total += ans\n        total %= mod\n    print(total)", "for tt in range(int(input())):\n    n = int(input())\n    s = input()\n    fx = [0] * n\n    fx[0] = 1\n    for i in range(1, n):\n        if s[i] != s[i - 1]:\n            fx[i] = 1\n        else:\n            fx[i] = fx[i - 1] * 2 % 998244353\n    print(sum(fx) % 998244353)", "import math\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input()\n    tot = 1\n    cnt = 1\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            cnt = cnt * 2 % 998244353\n            tot += cnt\n        else:\n            cnt = 1\n            tot += cnt\n        tot = tot % 998244353\n    print(tot)", "import math\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input()\n    tot = 1\n    cnt = 1\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            cnt = cnt * 2 % 998244353\n            tot += cnt\n        else:\n            cnt = 1\n            tot += cnt\n        tot = tot % 998244353\n    print(tot)", "for _ in range(int(input())):\n    n = int(input())\n    s = input()\n    ans = 1\n    curr = 1\n    mod = 998244353\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            curr = (curr + curr) % mod\n        else:\n            curr = 1\n        ans = (ans + curr) % mod\n    print(ans)", "t = int(input())\nwhile t:\n    n = int(input())\n    s = input()\n    mod = 998244353\n    ans = 1\n    pre = 1\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            pre = pre * 2\n            pre = pre % mod\n            ans = (ans + pre) % mod\n        else:\n            pre = 1\n            ans = (ans + pre) % mod\n    print(ans)\n    t -= 1", "def N():\n    return int(input())\n\ndef A():\n    return [int(x) for x in input().split()]\n\ndef S():\n    return input()\nM = 998244353\nfor _ in range(N()):\n    c = 1\n    n = N()\n    dp = [0 for i in range(n)]\n    dp[0] += 1\n    if 'codeforces' == 28226329:\n        print('Tanmay')\n    s = S()\n    for i in range(1, n):\n        if s[i - 1] == s[i]:\n            dp[i] = dp[i - 1] * 2 % M\n            c = (c + dp[i]) % M\n            continue\n        dp[i] = 1\n        c = (c + dp[i]) % M\n    print(c % M)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input()\n    zeros_min = 0\n    ones_min = 0\n    summa = 0\n    k = 1\n    L = '2'\n    for i in range(n):\n        if s[i] == L:\n            k <<= 1\n        else:\n            k = 1\n        L = s[i]\n        k %= 998244353\n        summa += k\n        summa %= 998244353\n    print(summa)", "for t in range(int(input())):\n    n = int(input())\n    s = list(map(int, list(input())))\n    ans = 1\n    curr = 1\n    mod = 998244353\n    for i in range(1, n):\n        if s[i] == s[i - 1]:\n            curr *= 2\n        else:\n            curr = 1\n        ans += curr\n        ans %= mod\n        curr %= mod\n    print(ans)", "import os\nimport math\nimport collections\nimport bisect\nimport functools\nimport itertools\nimport heapq\n\ndef solve(a, n):\n    if n == 1:\n        return 1\n    count = [[0, 0] for i in range(n)]\n    dp = [0] * n\n    dp[0] = 1\n    ans = 1\n    for i in range(1, n):\n        if a[i] != a[i - 1]:\n            dp[i] = 1\n        else:\n            dp[i] = 2 * dp[i - 1] % mod\n        ans = (ans + dp[i]) % mod\n    return ans\nmod = 998244353\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = [int(c) for c in input()]\n    res = solve(s, n)\n    print(res)", "n = int(input())\nfor j in range(0, n):\n    v = int(input())\n    a = input()\n    ans = 1\n    lz = -1\n    lf = -1\n    l = [0] * v\n    if a[0] == '0':\n        lz = 0\n    else:\n        lf = 0\n    l[0] = 1\n    for j in range(1, v):\n        if a[j] == '0':\n            if a[j - 1] == '1':\n                l[j] = 1\n            else:\n                l[j] = l[j - 1] * 2\n        elif a[j - 1] == '0':\n            l[j] = 1\n        else:\n            l[j] = l[j - 1] * 2\n        l[j] = l[j] % 998244353\n        ans = ans + l[j]\n        ans = ans % 998244353\n    print(ans)", "from sys import stdin, stdout\ninput = stdin.readline\nM = 998244353\npow2 = [1]\nfor i in range(200005):\n    pow2.append(pow2[-1] * 2 % M)\nfor _ in range(int(input())):\n    n = int(input())\n    ans = 0\n    count1 = 0\n    count0 = 0\n    for b in map(int, input().strip()):\n        if b:\n            count0 = 0\n            count1 += 1\n            ans = (ans + pow2[count1 - 1]) % M\n        else:\n            count1 = 0\n            count0 += 1\n            ans = (ans + pow2[count0 - 1]) % M\n    print(ans % M)", "for aa in range(int(input())):\n    n = int(input())\n    s = input()\n    x = []\n    a = 1\n    b = 1\n    c = 1\n    v = 1\n    for i in range(n):\n        if s[i] == '0':\n            v = 1\n            b = 1\n            if c == 1:\n                x.append(1)\n                c += 1\n                continue\n            if c > 1:\n                a = (a * 2 % 998244353 + 998244353) % 998244353\n                x.append(a)\n        if s[i] == '1':\n            a = 1\n            c = 1\n            if v == 1:\n                x.append(1)\n                v += 1\n                continue\n            if v > 1:\n                b = (b * 2 % 998244353 + 998244353) % 998244353\n                x.append(b)\n    print(sum(x) % 998244353)", "import math as mt\nMAXN = 10001\n\ndef sieve():\n    for i in range(4, MAXN, 2):\n        spf[i] = 2\n    for i in range(3, mt.ceil(mt.sqrt(MAXN))):\n        if spf[i] == i:\n            for j in range(i * i, MAXN, i):\n                if spf[j] == j:\n                    spf[j] = i\n\ndef getFactorization(x):\n    d = {}\n    while x != 1:\n        if spf[x] in d:\n            d[spf[x]] += 1\n        else:\n            d[spf[x]] = 1\n        x = x // spf[x]\n    return d\nfor _ in range(int(input())):\n    n = int(input())\n    s = input()\n    c = 1\n    ans = 1\n    for i in range(n - 1):\n        if s[i] == s[i + 1]:\n            c *= 2\n            c %= 998244353\n            ans += c\n            ans %= 998244353\n        else:\n            c = 1\n            ans += c\n    print(ans % 998244353)", "import sys\nimport math\nMOD = 998244353\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    string = input()\n    l = [[1] * 2 for _ in range(n)]\n    for i in range(1, n):\n        if string[i] == string[i - 1]:\n            l[i][0] = l[i - 1][0] * 2\n            l[i][0] %= MOD\n            l[i][1] = l[i - 1][1]\n        else:\n            l[i][0] = l[i - 1][1]\n            l[i][1] = l[i - 1][1]\n    ans2 = 0\n    for i in range(n):\n        ans2 += l[i][0]\n        ans2 %= MOD\n    print(ans2)", "test = int(input())\nfor tes in range(test):\n    n = int(input())\n    A = input()\n    R = 998244353\n    dp = [0] * n\n    dq = [0] * n\n    dp[0] = 1\n    dq[0] = 1\n    for i in range(1, n):\n        if A[i] == A[i - 1]:\n            dp[i] = dp[i - 1] * 2\n            dp[i] %= R\n            dq[i] = dq[i - 1]\n        else:\n            dp[i] = dq[i - 1]\n            dq[i] = dq[i - 1]\n    S = 0\n    for i in range(n):\n        S += dp[i]\n        S %= R\n    print(S)", "import sys\nimport math\nt = int(sys.stdin.readline())\nfor _ in range(t):\n    n = int(sys.stdin.readline())\n    s = sys.stdin.readline().strip()\n    s = '-' + s\n    ones = 0\n    zeros = 0\n    ans = 0\n    fixzeros = 0\n    fixones = 0\n    temp = 1\n    prevpower = 0\n    for m in range(1, n + 1):\n        if s[m] == '1':\n            ones += 1\n            present = ones\n            fixones = max(fixones, m - present)\n        else:\n            zeros += 1\n            present = zeros\n            fixzeros = max(fixzeros, m - present)\n        fix = fixzeros + fixones\n        newpower = m - 1 - fix\n        diffpower = newpower - prevpower\n        prevpower = newpower\n        temp = int(temp * pow(2, diffpower, 998244353)) % 998244353\n        ans = (ans + temp) % 998244353\n    print(ans)", "import sys\nimport math\n\ndef expmod(a, b, m):\n    a = a % m\n    res = 1\n    while b > 0:\n        if b & 1:\n            res = res * a % m\n        a = a * a % m\n        b = b >> 1\n    return res\n\ndef power(x, y, p):\n    res = 1\n    while y > 0:\n        if y & 1 != 0:\n            res = res * x\n        y = y >> 1\n        x = x * x\n    return res % p\nt = int(sys.stdin.readline())\nfor _ in range(t):\n    n = int(sys.stdin.readline())\n    s = sys.stdin.readline().strip()\n    s = '#' + s\n    ones = 0\n    zeros = 0\n    ans = 0\n    fix0 = 0\n    fix1 = 0\n    temp = 1\n    prevpower = 0\n    for m in range(1, n + 1):\n        if s[m] == '1':\n            ones += 1\n            present = ones\n            fix1 = max(fix1, m - present)\n        else:\n            zeros += 1\n            present = zeros\n            fix0 = max(fix0, m - present)\n        fix = fix0 + fix1\n        newpower = m - 1 - fix\n        diffpower = newpower - prevpower\n        prevpower = newpower\n        temp = int(temp * pow(2, diffpower, 998244353)) % 998244353\n        ans = (ans + temp) % 998244353\n    print(ans % 998244353)", "mod = 998244353\nT = int(input())\nfor t in range(T):\n    l = int(input())\n    a = input()\n    cnt = 1\n    ans = 1\n    temp = []\n    for i in range(1, l):\n        if a[i] == a[i - 1]:\n            temp.append(cnt)\n            cnt += 1\n        else:\n            cnt = 1\n            ans += 1\n    Cnt = {}\n    for t in temp:\n        if t in Cnt:\n            Cnt[t] += 1\n        else:\n            Cnt[t] = 1\n    for (x, y) in Cnt.items():\n        ans += y * pow(2, x, mod)\n        ans = ans % mod\n    print(ans)", "import sys\n\ndef fn(a, l):\n    if l == 1:\n        return 1\n    counter = 0\n    total = 1\n    for i in range(1, l):\n        if a[i] == a[i - 1]:\n            counter += 1\n            total += pow(2, counter, 998244353)\n        else:\n            counter = 0\n            total += 1\n    return total\ninput = sys.stdin.readlines()\nfor i in range(int(input[0].strip('\\n'))):\n    new_list = input[2 * i + 2].strip('\\n')\n    len_list = int(input[2 * i + 1].strip('\\n'))\n    out = fn(new_list, len_list) % 998244353\n    print(out)", "mod = 998244353\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    s = input()\n    ans = 1\n    zer = 0\n    one = 0\n    c0 = 0\n    c1 = 0\n    if s[0] == '1':\n        c1 += 1\n    else:\n        c0 += 1\n    for i in range(1, n):\n        if s[i] == '0':\n            c0 += 1\n            x = (c1 + i - c0) // 2 + 1\n            if zer < x:\n                zer = x\n            ans += pow(2, i - one - zer, mod)\n            ans = ans % mod\n        else:\n            c1 += 1\n            x = (c0 + i - c1) // 2 + 1\n            if one < x:\n                one = x\n            ans += pow(2, i - one - zer, mod)\n            ans = ans % mod\n    print(ans)"]