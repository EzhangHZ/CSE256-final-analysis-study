["MOD = 998244353\n\ndef solve():\n    (n, k) = map(int, input().split())\n    v = list(map(int, input().split()))\n    if k > 0 and sum((1 for x in v[-k:] if x > 0)) > 0:\n        print('0')\n        return\n    ans = 1\n    for i in range(2, k + 1):\n        ans = ans * i % MOD\n    for i in range(n - k):\n        if v[i] == -1:\n            ans = ans * (i + k + 1) % MOD\n        if v[i] == 0:\n            ans = ans * (k + 1) % MOD\n    print(ans)\nfor _ in range(int(input())):\n    solve()", "MOD = 998244353\n\ndef solve():\n    (n, k) = map(int, input().split())\n    v = list(map(int, input().split()))\n    if k > 0 and sum(v[-k:]) > 0:\n        print('0')\n        return\n    ans = 1\n    for i in range(2, k + 1):\n        ans = ans * i % MOD\n    for i in range(n - k):\n        if v[i] == -1:\n            ans = ans * (i + k + 1) % MOD\n        if v[i] == 0:\n            ans = ans * (k + 1) % MOD\n    print(ans)\nfor _ in range(int(input())):\n    solve()", "mod = 998244353\nt = int(input())\nfor _ in range(t):\n    (n, k) = map(int, input().split(' '))\n    f = 0\n    v = list(map(int, input().split()))\n    value = [0]\n    value.extend(v)\n    ans = 1\n    for i in range(1, k + 1):\n        ans = ans * i % mod\n    for i in range(n - k + 1, n + 1):\n        if value[i] != -1 and value[i]:\n            print(0)\n            f = 1\n            break\n    if f:\n        continue\n    for i in range(k + 1, n + 1):\n        limit = i - 1\n        if value[i - k] == -1:\n            ans = ans * i % mod\n        elif value[i - k]:\n            limit = value[i - k] + k\n            if limit > i - 1:\n                f = 1\n        else:\n            limit = min(limit, k)\n            ans = ans * (limit + 1) % mod\n    if f:\n        ans = 0\n    print(ans)"]