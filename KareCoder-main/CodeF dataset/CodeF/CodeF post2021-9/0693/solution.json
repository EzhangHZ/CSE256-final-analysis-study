["def nextstate(q, x):\n    i = 0\n    for i in range(len(q)):\n        if q[i] & x > 0:\n            return q[:i] + (x,) + q[i + 1:]\n    return q + (x,)\nqs = [()]\ntrans = []\nptr = 0\nwhile ptr < len(qs):\n    q = qs[ptr]\n    tb = []\n    for x in range(1, 4):\n        qn = nextstate(q, x)\n        if qn not in qs:\n            qs.append(qn)\n        tb.append(qs.index(qn))\n    trans.append(tb)\n    ptr += 1\nn = int(input())\na = [int(x) for x in input().split(' ')]\ncnt = [0] * len(qs)\ncnt[0] = 1\nans = 0\nfor (i, ai) in enumerate(a):\n    cnt2 = [0] * len(qs)\n    cnt2[0] = 1\n    if ai == 0:\n        for j in range(len(qs)):\n            cnt2[j] += cnt[j]\n        ans += (i + 1) * (n - i)\n    else:\n        for j in range(len(qs)):\n            qn = trans[j][ai - 1]\n            cnt2[qn] += cnt[j]\n    for j in range(len(qs)):\n        ans += cnt2[j] * len(qs[j])\n    cnt = cnt2\nprint(ans)"]