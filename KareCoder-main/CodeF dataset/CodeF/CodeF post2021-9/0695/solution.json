["import sys\nI = lambda : [*map(int, sys.stdin.readline().split())]\n\ndef consec(a):\n    tot = 0\n    big = float('inf')\n    neg = 0\n    for guy in a:\n        tot += abs(guy)\n        if abs(guy) < big:\n            big = abs(guy)\n        if guy < 0:\n            neg += 1\n    if neg % 2 == 0:\n        return (tot, tot - 2 * big)\n    return (tot - 2 * big, tot)\nimport math\n\ndef main():\n    (n, m) = I()\n    a = I()\n    b = I()\n    g = b[0]\n    for i in range(1, m):\n        g = math.gcd(g, b[i])\n    if g == 1:\n        print(sum((abs(guy) for guy in a)))\n        return\n    tot = 0\n    tot1 = 0\n    for i in range(g):\n        guy = []\n        j = i\n        while j < n:\n            guy.append(a[j])\n            j += g\n        (x, y) = consec(guy)\n        tot += x\n        tot1 += y\n    print(max(tot, tot1))\n(t,) = I()\nfor _ in range(t):\n    main()"]