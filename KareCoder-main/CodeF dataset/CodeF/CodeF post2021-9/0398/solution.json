["def ss(l):\n    n = len(l)\n    if sum(l) != 0:\n        return 'No'\n    t = 0\n    li = n - 1\n    while li >= 0 and l[li] == 0:\n        li -= 1\n    for i in range(n):\n        t += l[i]\n        if t <= 0 and i < li:\n            return 'No'\n    return 'Yes'\nfor _ in range(int(input())):\n    n = int(input())\n    l = list(map(int, input().split()))\n    print(ss(l))", "import math as m\ni = input()\ninp = []\nfor a in range(int(i)):\n    input()\n    inp.append([int(x) for x in input().split()])\n\ndef logic(arr):\n    n = len(arr)\n    j = n - 1\n    while j >= 0 and arr[j] == 0:\n        j -= 1\n    arr = arr[:j + 1]\n    if arr == []:\n        return 'Yes'\n    elif arr[0] < 1:\n        return 'No'\n    s = 0\n    n = len(arr)\n    for i in range(n):\n        s += arr[i]\n        if s <= 0 and i != n - 1:\n            return 'No'\n    if s == 0:\n        return 'Yes'\n    else:\n        return 'No'\nfor arr in inp:\n    print(logic(arr))", "def dirinc(N, array):\n    if array[0] < 0 or array[-1] > 0 or sum(array) != 0:\n        print('No')\n        return\n    runsum = 0\n    for i in range(N):\n        runsum = runsum + array[i]\n        if runsum < 0:\n            print('No')\n            return\n        if runsum == 0:\n            j = i + 1\n            while j < N:\n                if array[j] != 0:\n                    print('No')\n                    return\n                j = j + 1\n            break\n    print('Yes')\nM = int(input())\nfor i in range(M):\n    N = int(input())\n    array = list(map(int, input().split()))\n    dirinc(N, array)", "def directional(arr, n):\n    sum = 0\n    yes = True\n    for i in range(n):\n        sum += arr[i]\n        if sum < 0:\n            yes = False\n            break\n        if sum == 0:\n            for j in range(i + 1, n):\n                if arr[j] != 0:\n                    yes = False\n                    break\n            break\n    if sum == 0 and yes:\n        print('Yes')\n    else:\n        print('No')\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = list(map(int, input().split(' ')))\n    directional(arr, n)", "def check_r(n, l):\n    s = 0\n    for i in range(n):\n        s += l[i]\n        if s < 0:\n            return 'No'\n        if s == 0 and i != n - 1:\n            if l[i + 1] != 0:\n                return 'No'\n    if s == 0:\n        return 'Yes'\n    else:\n        return 'No'\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    l = list(map(int, input().split()))\n    print(check_r(n, l))", "def meow(n, l):\n    i = n - 1\n    sumo = 0\n    while i >= 0:\n        if l[i] == 0:\n            l.pop()\n        elif l[i] < 0:\n            if i == 0:\n                return 'No'\n                break\n            else:\n                break\n        else:\n            return 'No'\n            break\n        i = i - 1\n    if len(l) == 0:\n        return 'Yes'\n    elif i != 0:\n        while i >= 0:\n            sumo = sumo + l[i]\n            if i != 0:\n                if sumo > -1:\n                    return 'No'\n                    break\n                else:\n                    pass\n            elif sumo == 0:\n                return 'Yes'\n                break\n            else:\n                return 'No'\n                break\n            i = i - 1\n    else:\n        return 'No'\ntt = 0\nt = int(input())\nwhile tt < t:\n    n = int(input())\n    l = list(map(int, input().split()))\n    print(meow(n, l))\n    tt = tt + 1", "def func():\n    n = int(input())\n    arr = list(map(int, input().split()))\n    sm = sum(arr)\n    if sm != 0 or arr[0] < 0 or arr[-1] > 0:\n        print('No')\n        return\n    sm = arr[n - 1]\n    for i in range(n - 2, 0, -1):\n        if arr[i] != 0:\n            sm += arr[i]\n            if sm >= 0:\n                print('No')\n                return\n    print('Yes')\ntc = int(input())\nwhile tc > 0:\n    func()\n    tc -= 1", "from itertools import count\n\ndef isPossible(inp, n):\n    sum = 0\n    if inp[0] < 0:\n        return False\n    for i in inp:\n        sum += i\n    if sum != 0:\n        return False\n    if n <= 2:\n        return True\n    currSum = 0\n    pre = []\n    for i in inp:\n        currSum += i\n        pre.append(currSum)\n    flag = 0\n    for i in range(n - 1):\n        if pre[i] < 0:\n            return False\n        elif pre[i] == 0:\n            flag = 1\n        elif flag:\n            return False\n    return True\nt = int(input())\nwhile t:\n    t -= 1\n    n = int(input())\n    inp = list(map(int, input().split()))\n    if isPossible(inp, n):\n        print('Yes')\n    else:\n        print('No')", "s = int(input())\nfor _ in range(s):\n    n = int(input())\n    b = list(map(int, input().split()))\n    c = b[0]\n    for i in range(1, n):\n        if c < 0:\n            break\n        elif c == 0:\n            if b[i] != 0:\n                break\n        else:\n            c += b[i]\n    else:\n        if c == 0:\n            print('Yes')\n            continue\n    print('No')", "def solution():\n    n = int(input())\n    a = list(map(int, input().split()))\n    if sum(a) != 0:\n        print('No')\n        return\n    total = 0\n    flag = True\n    for i in reversed(a[1:]):\n        if flag:\n            if i == 0:\n                continue\n            else:\n                flag = False\n        total += i\n        if total >= 0:\n            print('No')\n            return\n    print('Yes')\ntry:\n    import sys\n    import os\n    if os.path.exists('.cpl_files/3.in.txt'):\n        sys.stdin = open('.cpl_files/3.in.txt', 'r')\n        sys.stdout = open('.cpl_files/3.out.txt', 'w')\nexcept:\n    pass\nt = int(input())\nwhile t:\n    solution()\n    t -= 1", "def solve():\n    n = int(input())\n    a = list(map(int, input().split()))\n    s = tag = 0\n    for i in range(n):\n        if a[i] and tag:\n            return False\n        s += a[i]\n        if s < 0:\n            return False\n        tag = s == 0\n    if s:\n        return False\n    return True\nT = int(input())\nfor _ in range(T):\n    if solve():\n        print('Yes')\n    else:\n        print('No')", "testcases = int(input())\nfor i in range(testcases):\n    n = int(input())\n    A = list(map(int, input().split()))\n    sum = A[0]\n    j = 1\n    while sum > 0 and j < n:\n        sum += A[j]\n        j += 1\n    if sum < 0:\n        print('No')\n    elif sum == 0:\n        f = A[j:]\n        b = True\n        for k in f:\n            if k != 0:\n                b = False\n        if b:\n            print('Yes')\n        else:\n            print('No')\n    elif j == n and sum != 0:\n        print('No')", "def solve():\n    n = int(input())\n    a = list(map(int, input().split()))\n    ind = -1\n    res = 0\n    if n == 1:\n        if a == [0]:\n            print('Yes')\n        else:\n            print('No')\n        return\n    for i in range(n):\n        if a[i] < res:\n            print('No')\n            return\n        res -= a[i]\n        if res == 0:\n            ind = i\n            break\n    if ind == -1:\n        print('No')\n        return\n    for i in range(ind + 1, n):\n        if a[i] != 0:\n            print('No')\n            return\n    print('Yes')\nt = int(input())\nfor i in range(t):\n    solve()", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    ans = 0\n    q = 0\n    for j in range(n - 1, 0, -1):\n        if arr[j] != 0:\n            ans += arr[j]\n            if ans >= 0:\n                q += 1\n                break\n    ans += arr[0]\n    if ans == 0 and q == 0:\n        print('Yes')\n    else:\n        print('No')", "for _ in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    i = n - 1\n    while a[i] == 0 and i > 0:\n        i -= 1\n    l = 0\n    ans = 'No'\n    while i >= 0:\n        l += a[i]\n        if l >= 0:\n            break\n        i -= 1\n    if i == 0 and l == 0:\n        ans = 'Yes'\n    print(ans)", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    s = input().split()\n    for i in range(len(s) - 1, -1, -1):\n        if s[i] != '0':\n            break\n        del s[i]\n    a = list(map(int, s))[::-1]\n    ok = True\n    if a:\n        if a[-1] <= 0:\n            ok = False\n        prefix = 0\n        for i in range(len(a) - 1):\n            prefix += a[i]\n            if prefix >= 0:\n                ok = False\n        if prefix + a[-1] != 0:\n            ok = False\n    if ok:\n        print('Yes')\n    else:\n        print('No')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    tot = a[0]\n    for i in range(1, n):\n        if tot < 0:\n            break\n        elif tot == 0:\n            if a[i] != 0:\n                break\n        else:\n            tot += a[i]\n    else:\n        if tot == 0:\n            print('Yes')\n            continue\n    print('No')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    tot = a[0]\n    for i in range(1, n):\n        if tot < 0:\n            break\n        elif tot == 0:\n            if a[i] != 0:\n                break\n        else:\n            tot += a[i]\n    else:\n        if tot == 0:\n            print('Yes')\n            continue\n    print('No')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    while n > 0 and a[n - 1] == 0:\n        n -= 1\n    su = 0\n    for i in range(0, n):\n        su += a[i]\n        if su < 0 or (su == 0 and i < n - 1):\n            su = -1\n            break\n    print('Yes' if su == 0 else 'No')", "MOD = 10 ** 9 + 7\nfac_mem = [1]\n\ndef fac(n):\n    while len(fac_mem) < n + 1:\n        fac_mem.append(fac_mem[-1] * len(fac_mem) % MOD)\n    return fac_mem[n]\n\ndef perm(n, k):\n    return fac(n) * pow(fac(k), MOD - 2, MOD) % MOD\n\ndef comb(n, k):\n    return fac(n) * pow(fac(k) * fac(n - k) % MOD, MOD - 2, MOD) % MOD\nfor case in range(int(input())):\n    n = int(input())\n    a = [int(j) for j in input().split()]\n    s = a[0]\n    possible = True\n    for i in a[1:]:\n        if s == 0 and i != 0 or s < 0:\n            possible = False\n        s += i\n    print(['No', 'Yes'][possible and s == 0])", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    tot = a[0]\n    for i in range(1, n):\n        if tot < 0:\n            break\n        elif tot == 0:\n            if a[i] != 0:\n                break\n        else:\n            tot += a[i]\n    else:\n        if tot == 0:\n            print('Yes')\n            continue\n    print('No')", "for _ in range(int(input())):\n    n = int(input())\n    if False:\n        print('Tanmay')\n    a = [int(x) for x in input().split()]\n    if sum(a) != 0 or a[0] < 0 or a[-1] > 0:\n        print('No')\n        continue\n    i = n - 1\n    while i > 0 and a[i] == 0:\n        i -= 1\n    s = 0\n    f = True\n    while i > 0:\n        s += a[i]\n        if s >= 0:\n            print('No')\n            f = False\n            break\n        i -= 1\n    if f:\n        print('Yes')", "def ispossible(arr, n):\n    i = 0\n    if n == 1:\n        if arr[i] == 0:\n            return True\n        else:\n            return False\n    else:\n        taken = 0\n        i = 0\n        j = n - 1\n        random_arr = [0] * n\n        while j >= 0 and arr[j] == random_arr[j]:\n            random_arr[j] = 1\n            j -= 1\n        while i < n:\n            if i == n - 1:\n                taken = taken + arr[i]\n                if taken == 0:\n                    return True\n                else:\n                    return False\n            else:\n                taken = taken + arr[i]\n                if taken == 0:\n                    if random_arr[i + 1] == 1:\n                        return True\n                    else:\n                        return False\n                elif taken < 0:\n                    return False\n                i += 1\nt = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    if ispossible(arr, n) == True:\n        print('Yes')\n    else:\n        print('No')", "strng = lambda : input()\ninp = lambda : int(input())\nmul = lambda : map(int, input().split())\njn = lambda x, l: x.join(map(str, l))\nstrlst = lambda : list(input())\nlst = lambda : list(map(int, input().split()))\ndd = lambda : defaultdict(lambda : 0)\nimport sys\ninput = sys.stdin.readline\nfrom collections import defaultdict\nfrom math import ceil, log, floor, sqrt, gcd, log10\nfor _ in range(inp()):\n    n = inp()\n    a = lst()\n    s = 0\n    flag = False\n    for i in range(n - 1, -1, -1):\n        s += a[i]\n        if s >= 0 and a[i] != 0 and (i != 0):\n            flag = True\n            break\n    if flag:\n        print('No')\n        continue\n    if s == 0:\n        print('Yes')\n        continue\n    print('No')", "import sys\n\ndef get_ints():\n    return map(int, sys.stdin.readline().strip().split())\n\ndef get_list():\n    return list(map(int, sys.stdin.readline().strip().split()))\n\ndef get_string():\n    return sys.stdin.readline().strip()\nt = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = get_list()\n\n    def solve():\n        if sum(arr) != 0:\n            return False\n        j = n - 1\n        while j > -1 and arr[j] == 0:\n            j -= 1\n        s = 0\n        for i in range(j + 1):\n            s += arr[i]\n            if s < 0:\n                return False\n            if s == 0 and i != j:\n                return False\n        return True\n    if solve():\n        print('Yes')\n    else:\n        print('No')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    if arr[0] == 0 and n == 1:\n        print('Yes')\n        continue\n    if arr[0] < 0:\n        print('No')\n        continue\n    cs = 0\n    flag = True\n    noted = -1\n    for i in range(n):\n        cs += arr[i]\n        if cs < 0:\n            print('No')\n            flag = False\n            break\n        if cs == 0:\n            noted = i\n            break\n    if flag:\n        if noted == -1:\n            print('No')\n        elif noted == n - 1:\n            print('Yes')\n        else:\n            flagt = True\n            for i in range(noted + 1, n):\n                if arr[i] != 0:\n                    flagt = False\n                    print('No')\n                    break\n            if flagt:\n                print('Yes')", "for i in range(int(input())):\n    n = int(input())\n    a = []\n    a = list(map(int, input().split()))\n    can = 1\n    if a[0] == 0:\n        if a == [0] * n:\n            print('Yes')\n        else:\n            print('No')\n    else:\n        sum = 0\n        reached_zero = 0\n        for j in range(n):\n            sum += a[j]\n            if sum < 0:\n                can = 0\n            if sum == 0:\n                reached_zero = 1\n            if reached_zero and sum != 0:\n                can = 0\n        if sum:\n            can = 0\n        print('Yes' if can else 'No')", "for _ in [0] * int(input()):\n    n = int(input())\n    s = [*map(int, input().split())]\n    index = -1\n    m = 0\n    for i in range(n):\n        m += s[i]\n        if m < 0:\n            break\n        if m == 0:\n            index = i + 1\n            break\n    if index == -1:\n        print('No')\n        continue\n    if index == n or (len(set(s[index:])) == 1 and s[index] == 0):\n        print('Yes')\n        continue\n    print('No')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    tot = a[0]\n    for i in range(1, n):\n        if tot < 0:\n            break\n        elif tot == 0:\n            if a[i] != 0:\n                break\n        else:\n            tot += a[i]\n    else:\n        if tot == 0:\n            print('Yes')\n            continue\n    print('No')", "for _ in range(int(input())):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    sumArr = 0\n    ans = 'Yes'\n    sumFoundZero = False\n    for i in range(n):\n        sumArr += arr[i]\n        if sumFoundZero and arr[i] != 0:\n            ans == 'No'\n            break\n        if sumArr < 0:\n            ans = 'No'\n            break\n        elif sumArr == 0:\n            sumFoundZero = True\n    if sumArr != 0:\n        ans = 'No'\n    print(ans)", "t = int(input())\nfor i in range(t):\n    n = int(input())\n    arr = list(map(int, input().strip().split()))[:n]\n    s = 0\n    flag = True\n    flag2 = True\n    flag3 = True\n    for ind in range(n):\n        s += arr[ind]\n        if s < 0:\n            flag = False\n            break\n        elif s == 0:\n            flag2 = False\n        elif flag2 is False and s > 0:\n            flag3 = False\n        else:\n            pass\n    if sum(arr) != 0:\n        print('No')\n    elif n == 1 & arr[0] != 0:\n        print('No')\n    elif flag is False:\n        print('No')\n    elif flag3 is False:\n        print('No')\n    else:\n        print('Yes')", "k = int(input())\nfor _ in range(k):\n    n = int(input())\n    a = list(map(int, input().split()))\n    b = a[0]\n    for i in range(1, n):\n        if b < 0:\n            break\n        elif b == 0:\n            if a[i] != 0:\n                break\n        else:\n            b += a[i]\n    else:\n        if b == 0:\n            print('Yes')\n            continue\n    print('No')", "k = int(input())\nfor _ in range(k):\n    n = int(input())\n    a = list(map(int, input().split()))\n    b = a[0]\n    for i in range(1, n):\n        if b < 0:\n            break\n        elif b == 0:\n            if a[i] != 0:\n                break\n        else:\n            b += a[i]\n    else:\n        if b == 0:\n            print('Yes')\n            continue\n    print('No')", "num_tests = int(input())\nfor _ in range(num_tests):\n    m = int(input())\n    arr = list(map(int, input().split()))\n    if sum(arr) != 0:\n        print('No')\n        continue\n    sm = 0\n    f = True\n    for i in range(m):\n        sm += arr[i]\n        if sm < 0:\n            print('No')\n            f = False\n            break\n        if sm == 0:\n            break\n    if f:\n        for j in range(m - 1, -1, -1):\n            if arr[j] != 0:\n                if j == i:\n                    print('Yes')\n                else:\n                    print('No')\n                break\n        if i == 0 and j == 0:\n            print('Yes')", "for _ in range(int(input())):\n    n = int(input())\n    a = list(map(int, input().split()))\n    t = 0\n    check = 0\n    for i in range(n):\n        t += a[i]\n        if t < 0:\n            check = 1\n            break\n        if t == 0 and i < n - 1:\n            for j in range(i + 1, n):\n                if a[j] != 0:\n                    check = 1\n                    break\n            break\n    if t != 0 and check == 0:\n        check = 1\n    if check == 1:\n        print('No')\n    else:\n        print('Yes')", "for _ in range(int(input())):\n    n = int(input())\n    arr = list(map(int, input().split()))\n    while n > 0:\n        if arr[n - 1] == 0:\n            del arr[n - 1]\n            n -= 1\n        else:\n            break\n    if n == 0:\n        print('Yes')\n    else:\n        cs = 0\n        flag = True\n        for i in range(n):\n            cs += arr[i]\n            if cs < 0:\n                flag = False\n            elif cs == 0 and i != n - 1:\n                flag = False\n        if cs != 0 or flag == False:\n            print('No')\n        else:\n            print('Yes')", "t = int(input())\nfor _ in range(t):\n    n = int(input())\n    a = list(map(int, input().split()))\n    if sum(a) != 0:\n        print('No')\n    else:\n        flag = 0\n        sum1 = 0\n        impossible = 0\n        for i in range(n - 1, 0, -1):\n            if flag == 0:\n                if a[i] != 0:\n                    flag = 1\n                    sum1 = a[i]\n                    if sum1 > 0:\n                        impossible = 1\n                        break\n            else:\n                sum1 += a[i]\n                if sum1 >= 0:\n                    impossible = 1\n                    break\n        if impossible == 1:\n            print('No')\n        else:\n            print('Yes')", "T = int(input())\nfor x in range(T):\n    n = int(input())\n    A = [int(d) for d in input().split()]\n    if sum(A) != 0:\n        print('No')\n        continue\n    if A[-1] > 0 or A[0] < 0:\n        print('No')\n        continue\n    end = n - 1\n    while A[end] == 0 and end > 0:\n        end -= 1\n    running = 0\n    good = True\n    for a in range(n):\n        running += A[a]\n        if running < 0:\n            good = False\n            break\n        if running == 0:\n            if a != end:\n                good = False\n            break\n    if good:\n        print('Yes')\n    else:\n        print('No')"]