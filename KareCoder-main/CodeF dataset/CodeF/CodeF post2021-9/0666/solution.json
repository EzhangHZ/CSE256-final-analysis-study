["def solve():\n    n = int(input())\n    s = input()\n    res = 0\n    cnt = [0 for _ in range(2 * n + 1)]\n    cnt_promise = [0] * 3\n    cur_bal = n\n    cnt[cur_bal] = 1\n    cnt_promise[cur_bal % 3] = 1\n    for c in s:\n        new_bal = cur_bal\n        if c == '-':\n            new_bal -= 1\n            cnt_promise[new_bal % 3] += cnt[new_bal]\n            res += cnt_promise[new_bal % 3]\n            cnt[new_bal] += 1\n            cnt_promise[new_bal % 3] += 1\n        else:\n            cnt_promise[new_bal % 3] -= cnt[new_bal]\n            new_bal += 1\n            res += cnt_promise[new_bal % 3]\n            cnt_promise[new_bal % 3] += 1\n            cnt[new_bal] += 1\n        cur_bal = new_bal\n    print(res)\nnum_test = int(input())\nfor t in range(num_test):\n    solve()", "for _ in range(int(input())):\n    count = [0] * (2 * int(input()) + 1)\n    f = [0] * 3\n    u = 0\n    count[u] += 1\n    f[u % 3] += 1\n    total = 0\n    for x in input():\n        if x == '-':\n            u -= 1\n            f[u % 3] += count[u]\n        else:\n            f[u % 3] -= count[u]\n            u += 1\n        total += f[u % 3]\n        count[u] += 1\n        f[u % 3] += 1\n    print(total)", "for _ in range(int(input())):\n    f = [0] * 3\n    count = [0] * (2 * int(input()) + 1)\n    u = 0\n    count[u] += 1\n    f[u % 3] += 1\n    ans = 0\n    for x in input():\n        if x == '-':\n            u -= 1\n            f[u % 3] += count[u]\n        else:\n            f[u % 3] -= count[u]\n            u += 1\n        ans += f[u % 3]\n        count[u] += 1\n        f[u % 3] += 1\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n        ans += f[new_bal % 3]\n        cnt_bal[new_bal] += 1\n        f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "tst = int(input())\nfor _ in range(tst):\n    n = int(input())\n    s = input()\n    f = [0 for i in range(3)]\n    cur_bal = n\n    cnt_bal = [0 for i in range(2 * n + 1)]\n    cnt_bal[cur_bal] += 1\n    f[cur_bal % 3] += 1\n    ans = 0\n    for i in range(n):\n        new_bal = cur_bal\n        if s[i] == '-':\n            new_bal -= 1\n            f[new_bal % 3] += cnt_bal[new_bal]\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        else:\n            f[new_bal % 3] -= cnt_bal[new_bal]\n            new_bal += 1\n            ans += f[new_bal % 3]\n            cnt_bal[new_bal] += 1\n            f[new_bal % 3] += 1\n        cur_bal = new_bal\n    print(ans)", "import collections\nfor _ in range(int(input())):\n    n = int(input())\n    l = 2 * n + 2\n    s = input().strip()\n    y = [[0] * (l + 1) for i in range(3)]\n\n    def upd(x, a):\n        while x <= l:\n            a[x] += 1\n            x += x & -x\n\n    def qry(x, a):\n        r = 0\n        while x > 0:\n            r += a[x]\n            x -= x & -x\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, y[t % 3])\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, y[t % 3])\n        upd(t, y[t % 3])\n    print(ans)", "import collections\nfor _ in range(int(input())):\n    n = int(input())\n    l = 2 * n + 2\n    s = input().strip()\n    y = [[0] * (l + 1) for i in range(3)]\n\n    def upd(x, a):\n        while x <= l:\n            a[x] += 1\n            x += x & -x\n\n    def qry(x, a):\n        r = 0\n        while x > 0:\n            r += a[x]\n            x -= x & -x\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, y[t % 3])\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, y[t % 3])\n        upd(t, y[t % 3])\n    print(ans)", "import collections\nfor _ in range(int(input())):\n    n = int(input())\n    l = 2 * n + 2\n    s = input().strip()\n    y = [[0] * (l + 1) for i in range(3)]\n\n    def upd(x, a):\n        while x <= l:\n            a[x] += 1\n            x += x & -x\n\n    def qry(x, a):\n        r = 0\n        while x > 0:\n            r += a[x]\n            x -= x & -x\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, y[t % 3])\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, y[t % 3])\n        upd(t, y[t % 3])\n    print(ans)", "import sys\ninput = sys.stdin.readline\nfor _ in range(int(input().strip())):\n    n = int(input())\n    (m, s) = (n + 1 << 1, input().strip())\n    T = [[0] * m for i in range(3)]\n\n    def upd(p, x):\n        while p < m:\n            T[x][p] += 1\n            p += p & -p\n\n    def qry(p, x):\n        r = 0\n        while p:\n            r += T[x][p]\n            p -= p & -p\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, t % 3)\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, t % 3)\n        upd(t, t % 3)\n    print(ans)", "def lowbit(x):\n    return x & -x\n\ndef getleftmore(nums):\n    unqiue_nums = list(set(nums))\n    unqiue_nums.sort(reverse=True)\n    d = {c: i + 1 for (i, c) in enumerate(unqiue_nums)}\n    n = len(unqiue_nums)\n    c = [0] * (n + 1)\n\n    def insert(x, val):\n        while x < n + 1:\n            c[x] += val\n            x += lowbit(x)\n\n    def query(x):\n        res = 0\n        while x > 0:\n            res += c[x]\n            x -= lowbit(x)\n        return res\n    res = 0\n    for num in nums:\n        insert(d[num], 1)\n        res += query(d[num]) - 1\n    return res\n\ndef promisingstring2(s):\n    total = 0\n    sums = [[] for _ in range(3)]\n    sums[0].append(0)\n    for c in s:\n        if c == '+':\n            total += 1\n        else:\n            total -= 1\n        sums[total % 3].append(total)\n    ans = 0\n    for nums in sums:\n        ans += getleftmore(nums)\n    return ans\nt = int(input())\nfor _ in range(t):\n    _ = input()\n    s = input()\n    print(promisingstring2(s))", "import sys\ninput = sys.stdin.readline\nfor _ in range(int(input().strip())):\n    n = int(input())\n    (m, s) = (n + 1 << 1, input().strip())\n    T = [[0] * m for i in range(3)]\n\n    def upd(p, x):\n        while p < m:\n            T[x][p] += 1\n            p += p & -p\n\n    def qry(p, x):\n        r = 0\n        while p:\n            r += T[x][p]\n            p -= p & -p\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, t % 3)\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, t % 3)\n        upd(t, t % 3)\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    (m, s) = (n + 1 << 1, input())\n    T = [[0] * m for i in range(3)]\n\n    def upd(p, x):\n        while p < m:\n            T[x][p] += 1\n            p += p & -p\n\n    def qry(p, x):\n        r = 0\n        while p:\n            r += T[x][p]\n            p -= p & -p\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, t % 3)\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, t % 3)\n        upd(t, t % 3)\n    print(ans)", "for _ in range(int(input())):\n    n = int(input())\n    (m, s) = (n + 1 << 1, input())\n    T = [[0] * m for i in range(3)]\n\n    def upd(p, x):\n        while p < m:\n            T[x][p] += 1\n            p += p & -p\n\n    def qry(p, x):\n        r = 0\n        while p:\n            r += T[x][p]\n            p -= p & -p\n        return r\n    ans = 0\n    t = n + 1\n    upd(t, t % 3)\n    for i in s:\n        t = t + (1 if i == '-' else -1)\n        ans += qry(t, t % 3)\n        upd(t, t % 3)\n    print(ans)"]