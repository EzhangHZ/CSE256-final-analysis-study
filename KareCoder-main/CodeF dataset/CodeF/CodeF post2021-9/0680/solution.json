["for t in range(int(input())):\n    input()\n    (n, m) = map(int, input().split())\n    nm = n * m\n    mass = [list(map(int, input().split())) for i in range(n)]\n    balance = max_a = max_b = 0\n    for i in mass:\n        balance += i[0] - i[1]\n        max_a += min(m, i[0])\n        max_b += min(m, i[1])\n    min_a = nm - max_b\n    if balance < nm - 2 * max_b:\n        eat_a = min_a\n    elif balance > 2 * max_a - nm:\n        eat_a = max_a\n    else:\n        eat_a = (nm + balance + 1) // 2\n    print(abs(balance - 2 * eat_a + nm))\n    rest_a = eat_a - min_a\n    for i in mass:\n        cur_a = max(m - i[1], 0)\n        add = min(rest_a, min(m - cur_a, i[0] - cur_a))\n        cur_a += add\n        rest_a -= add\n        print(f'{cur_a} {m - cur_a}')", "for t in range(int(input())):\n    input()\n    (n, m) = map(int, input().split())\n    nm = n * m\n    mass = [list(map(int, input().split())) for i in range(n)]\n    balance = max_a = max_b = 0\n    for i in mass:\n        balance += i[0] - i[1]\n        max_a += min(m, i[0])\n        max_b += min(m, i[1])\n    min_a = nm - max_b\n    if balance < nm - 2 * max_b:\n        eat_a = min_a\n    elif balance > 2 * max_a - nm:\n        eat_a = max_a\n    else:\n        eat_a = (nm + balance + 1) // 2\n    print(abs(balance - 2 * eat_a + nm))\n    rest_a = eat_a - min_a\n    for i in mass:\n        cur_a = max(m - i[1], 0)\n        add = min(rest_a, min(m - cur_a, i[0] - cur_a))\n        cur_a += add\n        rest_a -= add\n        print(f'{cur_a} {m - cur_a}')", "for t in range(int(input())):\n    input()\n    (n, m) = map(int, input().split())\n    t = n * m\n    q = [list(map(int, input().split())) for i in range(n)]\n    x = j = k = 0\n    for i in q:\n        x += i[0] - i[1]\n        j += min(m, i[0])\n        k += min(m, i[1])\n    b = t - k\n    e = b if x < t - 2 * k else j if x > 2 * j - t else (t + x + 1) // 2\n    print(abs(x - 2 * e + t))\n    r = e - b\n    for i in q:\n        c = max(m - i[1], 0)\n        a = min(r, min(m - c, i[0] - c))\n        c += a\n        r -= a\n        print(f'{c} {m - c}')", "for t in range(int(input())):\n    input()\n    (n, m) = map(int, input().split())\n    nm = n * m\n    mass = [list(map(int, input().split())) for i in range(n)]\n    balance = max_a = max_b = 0\n    for i in mass:\n        balance += i[0] - i[1]\n        max_a += min(m, i[0])\n        max_b += min(m, i[1])\n    min_a = nm - max_b\n    if balance < nm - 2 * max_b:\n        eat_a = min_a\n    elif balance > 2 * max_a - nm:\n        eat_a = max_a\n    else:\n        eat_a = (nm + balance + 1) // 2\n    print(abs(balance - 2 * eat_a + nm))\n    rest_a = eat_a - min_a\n    for i in mass:\n        cur_a = max(m - i[1], 0)\n        add = min(rest_a, min(m - cur_a, i[0] - cur_a))\n        cur_a += add\n        rest_a -= add\n        print(f'{cur_a} {m - cur_a}')", "for t in range(int(input())):\n    input()\n    (n, m) = map(int, input().split())\n    t = n * m\n    q = [list(map(int, input().split())) for i in range(n)]\n    x = j = k = 0\n    for i in q:\n        x += i[0] - i[1]\n        j += min(m, i[0])\n        k += min(m, i[1])\n    b = t - k\n    e = b if x < t - 2 * k else j if x > 2 * j - t else (t + x + 1) // 2\n    print(abs(x - 2 * e + t))\n    r = e - b\n    for i in q:\n        c = max(m - i[1], 0)\n        a = min(r, min(m - c, i[0] - c))\n        c += a\n        r -= a\n        print(f'{c} {m - c}')"]