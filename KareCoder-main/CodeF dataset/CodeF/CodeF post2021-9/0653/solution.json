["import sys\nZ = sys.stdin.readline\nY = lambda : map(int, Z().split())\nX = range\nfrom collections import defaultdict as D\n\nclass U:\n\n    def __init__(self, n):\n        self.p = [*X(n)]\n\n    def f(self, a):\n        b = a\n        while a != self.p[a]:\n            a = self.p[a]\n        while b != a:\n            (self.p[b], b) = (a, self.p[b])\n        return a\nO = []\nN = 10 ** 10\nfor _ in X(int(Z())):\n    Z()\n    (n, k) = Y()\n    G = D(list)\n    a = []\n    u = U(n)\n    b = []\n    for i in X(n):\n        (x, y, t) = Y()\n        a.append(t)\n        G[x].append((y, i))\n        G[y + N].append((x, i))\n    for x in G:\n        g = G[x]\n        L = len(g)\n        g.sort()\n        if L > 1:\n            for i in X(1, L):\n                v = u.f(g[i - 1][1])\n                w = u.f(g[i][1])\n                if v != w and g[i][0] - g[i - 1][0] <= k:\n                    u.p[w] = v\n                    a[v] = min(a[v], a[w])\n                    a[w] = N\n    b = sorted((i for i in a if i < N))\n    c = 0\n    while c < len(b) - 1 and b[-2 - c] > c:\n        c += 1\n    print(c)", "import sys\nZ = sys.stdin.readline\nY = lambda : map(int, Z().split())\nX = range\nfrom collections import defaultdict as D\n\nclass U:\n\n    def __init__(self, n):\n        self.p = [*X(n)]\n\n    def f(self, a):\n        b = a\n        while a != self.p[a]:\n            a = self.p[a]\n        while b != a:\n            (self.p[b], b) = (a, self.p[b])\n        return a\nO = []\nN = 10 ** 10\nfor _ in X(int(Z())):\n    Z()\n    (n, k) = Y()\n    G = D(list)\n    a = []\n    u = U(n)\n    b = []\n    for i in X(n):\n        (x, y, t) = Y()\n        a.append(t)\n        G[x].append((y, i))\n        G[y + N].append((x, i))\n    for x in G:\n        g = G[x]\n        L = len(g)\n        g.sort()\n        if L > 1:\n            for i in X(1, L):\n                v = u.f(g[i - 1][1])\n                w = u.f(g[i][1])\n                if v != w and g[i][0] - g[i - 1][0] <= k:\n                    u.p[w] = v\n                    a[v] = min(a[v], a[w])\n                    a[w] = N\n    b = sorted((i for i in a if i < N))\n    c = 0\n    while c < len(b) - 1 and b[-2 - c] > c:\n        c += 1\n    print(c)", "import sys\nZ = sys.stdin.readline\nY = lambda : map(int, Z().split())\nX = range\nfrom collections import defaultdict as D\n\nclass U:\n\n    def __init__(self, n):\n        self.p = [*X(n)]\n\n    def f(self, a):\n        b = a\n        while a != self.p[a]:\n            a = self.p[a]\n        while b != a:\n            (self.p[b], b) = (a, self.p[b])\n        return a\nO = []\nN = 10 ** 10\nfor _ in X(int(Z())):\n    Z()\n    (n, k) = Y()\n    G = D(list)\n    a = []\n    u = U(n)\n    b = []\n    for i in X(n):\n        (x, y, t) = Y()\n        a.append(t)\n        G[x].append((y, i))\n        G[y + N].append((x, i))\n    for x in G:\n        g = G[x]\n        L = len(g)\n        g.sort()\n        if L > 1:\n            for i in X(1, L):\n                v = u.f(g[i - 1][1])\n                w = u.f(g[i][1])\n                if v != w and g[i][0] - g[i - 1][0] <= k:\n                    u.p[w] = v\n                    a[v] = min(a[v], a[w])\n                    a[w] = N\n    b = sorted((i for i in a if i < N))\n    c = 0\n    while c < len(b) - 1 and b[-2 - c] > c:\n        c += 1\n    print(c)", "import sys\nZ = sys.stdin.readline\nY = lambda : map(int, Z().split())\nX = range\nfrom collections import defaultdict as D\n\nclass U:\n\n    def __init__(self, n):\n        self.p = [*X(n)]\n\n    def f(self, a):\n        b = a\n        while a != self.p[a]:\n            a = self.p[a]\n        while b != a:\n            (self.p[b], b) = (a, self.p[b])\n        return a\nO = []\nN = 10 ** 10\nfor _ in X(int(Z())):\n    Z()\n    (n, k) = Y()\n    G = D(list)\n    a = []\n    u = U(n)\n    b = []\n    for i in X(n):\n        (x, y, t) = Y()\n        a.append(t)\n        G[x].append((y, i))\n        G[y + N].append((x, i))\n    for x in G:\n        g = G[x]\n        L = len(g)\n        g.sort()\n        if L > 1:\n            for i in X(1, L):\n                v = u.f(g[i - 1][1])\n                w = u.f(g[i][1])\n                if v != w and g[i][0] - g[i - 1][0] <= k:\n                    u.p[w] = v\n                    a[v] = min(a[v], a[w])\n                    a[w] = N\n    b = sorted((i for i in a if i < N))\n    c = 0\n    while c < len(b) - 1 and b[-2 - c] > c:\n        c += 1\n    print(c)"]